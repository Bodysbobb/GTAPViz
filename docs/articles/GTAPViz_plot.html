<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GTAPViz: Visualizing GTAP Model Results â€¢ GTAPViz</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="GTAPViz: Visualizing GTAP Model Results">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GTAPViz</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/GTAPViz_data_processing.html">GTAPViz: Automating GTAP Data Processing with HARplus</a>
    </li>
    <li>
      <a href="../articles/GTAPViz_plot.html">GTAPViz: Visualizing GTAP Model Results</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/bodysbobb/HARplus/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>GTAPViz: Visualizing GTAP Model Results</h1>
                        <h4 data-toc-skip class="author">Pattawee
Puangchit</h4>
            
            <h4 data-toc-skip class="date">2025-02-26</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/bodysbobb/HARplus/blob/HEAD/vignettes/GTAPViz_plot.Rmd" class="external-link"><code>vignettes/GTAPViz_plot.Rmd</code></a></small>
      <div class="hidden name"><code>GTAPViz_plot.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="sec:introduction">Introduction<a class="anchor" aria-label="anchor" href="#sec:introduction"></a>
</h2>
<p>GTAPViz, built on the <strong>HARplus</strong> package, enhances the
visualization of GTAP model results, making it easier for users to
interpret and communicate economic simulation outputs. This vignette
demonstrates how to create structured, publication-ready figures using
GTAPVizâ€™s built-in visualization tools.</p>
<p>The visualization framework relies on the
<strong><code>SL4Plot</code></strong> and
<strong><code>HARPlot</code></strong> sheets, which specify the
variables and figure titles used for plotting. Users can define these
directly within an external mapping file or generate them dynamically in
the R environment.</p>
<p>By leveraging HARplus for data extraction and GTAPViz for
visualization, this package provides a streamlined workflow to generate
insightful graphs without requiring extensive manual coding.</p>
<p>For an overview of data processing functionalities, refer to the
separate vignette:<br><a href="https://github.com/Bodysbobb/HARplus" class="external-link"></a>.</p>
</div>
<div class="section level2">
<h2 id="sec:project-setting">Project Directory<a class="anchor" aria-label="anchor" href="#sec:project-setting"></a>
</h2>
<p>To use this R code, all solution files, including <code>.sl4</code>
and <code>.har</code>, must be saved from RUNGTAP or CMD and placed in
the same folder.</p>
<p>Adjust the <code>&lt;project.folder&gt;</code> directory to your
desired path. If you maintain the same folder structure as in this code,
you may not need to modify the input
(<code>&lt;input.folder&gt;</code>), output
(<code>&lt;output.folder&gt;</code>), or mapping
(<code>&lt;map.folder&gt;</code>) directories.</p>
<p>By default, this R code assumes that
<code>&lt;project.folder&gt;</code> contains the following three main
folders:</p>
<ul>
<li>
<strong>in</strong> â€“ Stores all input files (i.e.,
<code>.sl4</code> and <code>.har</code>). See the <a href="#sec:input-files">Solution files</a> for details.</li>
<li>
<strong>out</strong> â€“ Stores all exported output files.</li>
<li>
<strong>map</strong> â€“ Stores the mapping <code>.xlsx</code> file
(<strong>critical for processing</strong>).</li>
</ul>
<div style="font-family: monospace; background-color: #282C34; color: #ABB2BF; padding: 10px; border-radius: 5px; width: fit-content;">
<p>ðŸ“‚ project.folder/ <br> â”œâ”€â”€ ðŸ“‚ in/ <span style="color: #61AFEF;">#
Stores input files (<code>.sl4</code>, <code>.har</code>)</span> <br>
â”œâ”€â”€ ðŸ“‚ out/ <span style="color: #98C379;"># Stores output files</span>
<br> â”œâ”€â”€ ðŸ“‚ map/ <span style="color: #E5C07B;"># Stores the mapping file
(<code>OutputMapping.xlsx</code>)</span> <br></p>
</div>
<p>: Example of Project Folder</p>
</div>
<div class="section level2">
<h2 id="sec:mapping-files">Mapping Files<a class="anchor" aria-label="anchor" href="#sec:mapping-files"></a>
</h2>
<p>The <strong><code>&lt;OutputMapping.xlsx&gt;</code></strong>
specifies the variables to extract from the solution files
<code>&lt;SL4File sheet&gt;</code> and the HAR file
<code>&lt;HARFile sheet&gt;</code>. All required variables must be
listed in the <code>"Variable"</code> column.</p>
<p>For <code>"Description"</code> and <code>"Unit"</code>, you may:</p>
<ul>
<li><p>Leave the columns blank and put <code>"No"</code> in
<code>&lt;info.mode&gt;</code> <a href="#sec:setting">setting</a> to
exclude these columns.<br></p></li>
<li><p>Manually define <strong>all variables</strong> and put
<code>"Yes"</code> in <code>&lt;info.mode&gt;</code> <a href="#sec:setting">setting</a>.</p></li>
<li><p>Leave the columns blank and put <code>"GTAPv7"</code> in
<code>&lt;info.mode&gt;</code> <a href="#sec:setting">setting</a> to get
the default definition and unit based on GTAPv7.<br></p></li>
<li><p>Define only some variables, leave others blank, and put
<code>"Mix"</code> in <code>&lt;info.mode&gt;</code> <a href="#sec:setting">setting</a> to get the definition based on your
input for defined variables and the GTAP default for the
others.</p></li>
</ul>
<table class="table">
<caption>Example of SL4File and HARFile sheet</caption>
<thead><tr class="header">
<th>Variable</th>
<th>Description</th>
<th>Unit</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>qgdp</td>
<td>Real GDP Index (%)</td>
<td>percent</td>
</tr>
<tr class="even">
<td>EV</td>
<td>Welfare Equivalents</td>
<td>million USD</td>
</tr>
<tr class="odd">
<td>pebfactreal</td>
<td>Cost of endownment</td>
<td>percent</td>
</tr>
</tbody>
</table>
<p>The <code>&lt;SL4Plot sheet&gt;</code> and
<code>&lt;HARPlot sheet&gt;</code> are used for creating figure
illustrations. Instructions for this can be found in another vignette
called <em>GTAPViz_plot</em>. Essentially, the table contains two
columns: <code>"Variable"</code>, which specifies the data used for
figure creation, and <code>"PlotTitle"</code>, which defines the figure
name. Users familiar with the R language can also create this table as a
dataframe within the R environment.</p>
<table class="table">
<caption>Example of SL4Plot and HARPlot sheet</caption>
<thead><tr class="header">
<th>Variable</th>
<th>PlotTitle</th>
<th>Unit</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>qgdp</td>
<td>Real GDP Index</td>
<td>percent</td>
</tr>
<tr class="even">
<td>EV</td>
<td>Welfare Equivalents</td>
<td>million USD</td>
</tr>
<tr class="odd">
<td>ppriv</td>
<td>Consumer Price Index</td>
<td>percent</td>
</tr>
</tbody>
</table>
<p>ðŸ’¡ <strong>Note:</strong> The mapping file
(<code>&lt;OutputMapping.xlsx&gt;</code>) can also be manually created
in R as a dataframe, provided that it follows the exact structure,
including column names. The dataframe must contain at least the
<code>"Variable"</code> column, while <code>"Description"</code> and
<code>"Unit"</code> columns are optional depending on the selected
<code>&lt;info.mode&gt;</code>.</p>
<p>For example, the following R code creates an equivalent mapping
dataframe:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mapping_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"qgdp"</span>, <span class="st">"EV"</span>, <span class="st">"ppriv"</span><span class="op">)</span>,</span>
<span>  PlotTitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Real GDP Index"</span>, <span class="st">"Welfare Equivalents"</span>, <span class="st">"Cost of endowment"</span><span class="op">)</span>,</span>
<span>  Unit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Percent"</span>, <span class="st">"million USD"</span>, <span class="st">"percent"</span><span class="op">)</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="sec:input-files">Input Files<a class="anchor" aria-label="anchor" href="#sec:input-files"></a>
</h2>
<p>The <code>&lt;case.name&gt;</code> variable in <a href="#sec:setting">setting</a> contains experiment names from which
results will be extracted and merged into a single output for further
analysis, such as graph creation. Multiple experiments can be included,
but increasing their number will extend processing time.</p>
<div class="section level3">
<h3 id="input-files-format">Input Files Format<a class="anchor" aria-label="anchor" href="#input-files-format"></a>
</h3>
<p>All input files must be stored in <code>&lt;input.folder&gt;</code>
(default: <code>"in"</code> inside <code>&lt;project.folder&gt;</code>).
File names must follow <code>&lt;case.name&gt;</code> to ensure
consistency between input each <code>.sl4</code> file must have a
corresponding <code>-WEL.HAR</code> file</p>
<ul>
<li>
<code>EXP1.sl4</code>, <code>EXP1-WEL.har</code>
</li>
<li>
<code>EXP2.sl4</code>, <code>EXP2-WEL.har</code>
</li>
</ul>
<div style="font-family: monospace; background-color: #282C34; color: #ABB2BF; padding: 10px; border-radius: 5px; width: fit-content;">
<p>ðŸ“‚ in/ <br> â”œâ”€â”€ ðŸ“„ EXP1.sl4 <br> â”œâ”€â”€ ðŸ“„ EXP1-WEL.har <br> â”œâ”€â”€ ðŸ“„
EXP2.sl4 <br> â”œâ”€â”€ ðŸ“„ EXP2-WEL.har <br></p>
</div>
<p>: Example of Input Files within the Input Folder</p>
</div>
</div>
<div class="section level2">
<h2 id="sample-data">Sample Data<a class="anchor" aria-label="anchor" href="#sample-data"></a>
</h2>
<p>Sample data used in this vignette is obtained from the GTAPv7 model
and utilizes publicly available data from the GTAP 9 database. For more
details, refer to the <a href="https://www.gtap.agecon.purdue.edu/databases/archives.asp" class="external-link">GTAP
Database Archive</a>.</p>
</div>
<div class="section level2">
<h2 id="loading-package">Loading Package<a class="anchor" aria-label="anchor" href="#loading-package"></a>
</h2>
<p>Before proceeding, ensure that <code>GTAPViz</code> and
<code>HARplus</code> are installed and loaded:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bodysbobb/HARplus" class="external-link">GTAPViz</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="sec:setting">Input Setup<a class="anchor" aria-label="anchor" href="#sec:setting"></a>
</h2>
<p>This chunk defines the <strong>experiment names</strong>,
<strong>handling of description and unit columns</strong>, and
<strong>output formats</strong> for processing GTAP model results.</p>
<ul>
<li>
<strong>Experiment Names (<code>experiment</code>)</strong>:<br>
Specifies the names of experiments to process, matching the prefixes of
<code>.sl4</code> and <code>.har</code> files.<br>
Example:
<ul>
<li>
<code>EXP1.sl4</code> and <code>EXP1-WEL.har</code> â†’ Processed as
<code>EXP1</code>.<br>
</li>
<li>
<code>EXP2.sl4</code> and <code>EXP2-WEL.har</code> â†’ Processed as
<code>EXP2</code>.</li>
</ul>
</li>
<li>
<strong>Description and Unit Handling
(<code>info.mode</code>)</strong>:<br>
Determines how the <code>"Description"</code> and <code>"Unit"</code>
columns are included in the output:
<ul>
<li>
<code>"Yes"</code> â†’ Use manually defined descriptions and units
from the mapping file.<br>
</li>
<li>
<code>"No"</code> â†’ Exclude the <code>"Description"</code> and
<code>"Unit"</code> columns.<br>
</li>
<li>
<code>"GTAPv7"</code> â†’ Use default definitions and units based on
<strong>GTAP Model Version 7</strong>.<br>
</li>
<li>
<code>"Mix"</code> â†’ Use manually defined values where available,
and GTAP defaults for the rest.</li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define experiment name / output name </span></span>
<span><span class="va">case.name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"US_All"</span>, <span class="st">"US_All_RetalTar"</span>, <span class="st">"US_All_ReduceTar50"</span>, <span class="st">"US_All_RegReduceTar50"</span>,</span>
<span>                    <span class="st">"US_All10"</span>, <span class="st">"US_All10_RetalTar"</span>, <span class="st">"US_All10_ReduceTar50"</span>, <span class="st">"US_All10_RegReduceTar50"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Adding Description / Unit (Yes/No/GTAPv7/Mix)</span></span>
<span><span class="va">info.mode</span> <span class="op">&lt;-</span> <span class="st">"GTAPv7"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="preparing-input-data">Preparing Input Data<a class="anchor" aria-label="anchor" href="#preparing-input-data"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define variables to extract</span></span>
<span><span class="co"># Region to be plotted</span></span>
<span><span class="va">selected_regions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"USA"</span>, <span class="st">"CHN"</span>, <span class="st">"CAN"</span>, <span class="st">"ASEAN"</span>, <span class="st">"ROW"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Sector to be plotted (NULL to select all)</span></span>
<span><span class="va">selected_sector</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span></span>
<span><span class="co"># Extract data with region and experiment filters</span></span>
<span><span class="va">plot.dta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_gtap_data.html">plot_gtap_data</a></span><span class="op">(</span></span>
<span>  sl4file  <span class="op">=</span> <span class="va">sl4plot</span>,</span>
<span>  harfile <span class="op">=</span> <span class="va">harplot</span>, </span>
<span>  experiment  <span class="op">=</span> <span class="va">case.name</span>,</span>
<span>  mapping_info <span class="op">=</span> <span class="va">info.mode</span>, </span>
<span>  region_select  <span class="op">=</span> <span class="va">selected_regions</span>,</span>
<span>  sector_select <span class="op">=</span> <span class="va">selected_sector</span>,</span>
<span>  project_dir <span class="op">=</span> <span class="va">project.folder</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; âœ… All files verified successfully.</span></span>
<span></span>
<span><span class="co"># Convert Value if Needed</span></span>
<span><span class="va">sl4.plot.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convert_units.html">convert_units</a></span><span class="op">(</span></span>
<span>  <span class="va">sl4.plot.data</span>,</span>
<span>  change_unit_from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"million USD"</span><span class="op">)</span>,</span>
<span>  change_unit_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"billion USD"</span><span class="op">)</span>,</span>
<span>  adjustment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"/1000"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">har.plot.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convert_units.html">convert_units</a></span><span class="op">(</span></span>
<span>  <span class="va">har.plot.data</span>,</span>
<span>  change_unit_from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"million USD"</span><span class="op">)</span>,</span>
<span>  change_unit_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"billion USD"</span><span class="op">)</span>,</span>
<span>  adjustment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"/1000"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert the column name if needed</span></span>
<span><span class="va">rename_col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  old <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"REG"</span>, <span class="st">"COMM"</span>, <span class="st">"ACTS"</span><span class="op">)</span>,</span>
<span>  new <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Region"</span>, <span class="st">"Commodity"</span>, <span class="st">"Activity"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">sl4.plot.data</span> <span class="op">&lt;-</span> <span class="fu">HARplus</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/HARplus/man/rename_dims.html" class="external-link">rename_dims</a></span><span class="op">(</span><span class="va">sl4.plot.data</span>, <span class="va">rename_col</span><span class="op">)</span></span>
<span><span class="va">har.plot.data</span> <span class="op">&lt;-</span> <span class="fu">HARplus</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/HARplus/man/rename_dims.html" class="external-link">rename_dims</a></span><span class="op">(</span><span class="va">har.plot.data</span>, <span class="va">rename_col</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define the sublists to keep in the first list</span></span>
<span><span class="va">reg_dim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"qgdp"</span>, <span class="st">"ppriv"</span>, <span class="st">"EV"</span>, <span class="st">"tot"</span>, <span class="st">"u"</span><span class="op">)</span></span>
<span><span class="va">reg_sl4</span> <span class="op">&lt;-</span> <span class="va">sl4.plot.data</span><span class="op">[</span><span class="va">reg_dim</span><span class="op">]</span></span>
<span><span class="va">reg_sl4_map</span> <span class="op">&lt;-</span> <span class="va">sl4plot</span><span class="op">[</span><span class="va">sl4plot</span><span class="op">$</span><span class="va">Variable</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">reg_dim</span>, <span class="op">]</span></span>
<span><span class="va">reg_oth_sl4</span> <span class="op">&lt;-</span> <span class="va">sl4.plot.data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">setdiff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">sl4.plot.data</span><span class="op">)</span>, <span class="va">reg_dim</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">reg_oth_map</span> <span class="op">&lt;-</span> <span class="va">sl4plot</span><span class="op">[</span><span class="op">!</span><span class="va">sl4plot</span><span class="op">$</span><span class="va">Variable</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">reg_dim</span>, <span class="op">]</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="comparison-plot">Comparison Plot<a class="anchor" aria-label="anchor" href="#comparison-plot"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">reg_sl4</span>, <span class="kw">function</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/comparison_plot.html">comparison_plot</a></span><span class="op">(</span><span class="va">df</span>,</span>
<span>                  x_axis_from <span class="op">=</span> <span class="st">"Region"</span>,</span>
<span>                  plot_var <span class="op">=</span> <span class="va">reg_sl4_map</span>,</span>
<span>                  title_prefix <span class="op">=</span> <span class="st">"Impact on"</span>,</span>
<span>                  output_dir <span class="op">=</span> <span class="va">output.folder</span>,</span>
<span>                  compare_by_x_axis <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  separate_figure <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  color_tone <span class="op">=</span> <span class="st">"grey"</span>,</span>
<span>                  width <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                  height <span class="op">=</span> <span class="fl">12</span>,</span>
<span>                  legend_position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; $qgdp</span></span></code></pre></div>
<p><img src="GTAPViz_plot_files/figure-html/Comparison%20Plot-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ppriv</span></span></code></pre>
<p><img src="GTAPViz_plot_files/figure-html/Comparison%20Plot-2.png" width="700"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $EV</span></span></code></pre>
<p><img src="GTAPViz_plot_files/figure-html/Comparison%20Plot-3.png" width="700"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $tot</span></span></code></pre>
<p><img src="GTAPViz_plot_files/figure-html/Comparison%20Plot-4.png" width="700"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $u</span></span></code></pre>
<p><img src="GTAPViz_plot_files/figure-html/Comparison%20Plot-5.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/report_table.html">report_table</a></span><span class="op">(</span><span class="va">reg_sl4</span>, vars <span class="op">=</span> <span class="va">reg_sl4_map</span><span class="op">$</span><span class="va">Variable</span>, </span>
<span>             col_names <span class="op">=</span> <span class="va">reg_sl4_map</span><span class="op">$</span><span class="va">PlotTitle</span>,  </span>
<span>             x_axis_from <span class="op">=</span> <span class="st">"Region"</span>,</span>
<span>             output_dir <span class="op">=</span> <span class="va">output.folder</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="gtap-macro-variable-plot-i-e--scalar-plot-without-region">GTAP MAcro Variable Plot (i.e., Scalar Plot without Region)<a class="anchor" aria-label="anchor" href="#gtap-macro-variable-plot-i-e--scalar-plot-without-region"></a>
</h2>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Macros</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">gtap_macros_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">input.folder</span>, <span class="st">"/"</span>, <span class="va">case.name</span>, <span class="st">".sl4"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>experiment_names <span class="op">=</span> <span class="va">case.name</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Selecting Variables</span></span>
<span><span class="va">selected_marcro</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pgdpwld"</span>, <span class="st">"qgdpwld"</span>, <span class="st">"vgdpwld"</span><span class="op">)</span></span>
<span><span class="va">macros_new_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pgdpwld"</span>, <span class="st">"qgdpwld"</span>, <span class="st">"vgdpwld"</span><span class="op">)</span></span>
<span><span class="va">macro.map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Variable <span class="op">=</span> <span class="va">selected_marcro</span>,</span>
<span>  PlotTitle <span class="op">=</span> <span class="va">macros_new_name</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plotting</span></span>
<span><span class="fu"><a href="../reference/macro_plot.html">macro_plot</a></span><span class="op">(</span><span class="va">Macros</span>,</span>
<span>           plot_var <span class="op">=</span> <span class="va">macro.map</span>,</span>
<span>           compare_by_x_axis <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>           color_tone <span class="op">=</span> <span class="st">"grey"</span>,</span>
<span>           output_dir <span class="op">=</span> <span class="va">output.folder</span>,</span>
<span>           panel_rows <span class="op">=</span> <span class="fl">2</span>,</span>
<span>           width <span class="op">=</span> <span class="fl">45</span>,</span>
<span>           separate_figure <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>           legend_position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<p><img src="GTAPViz_plot_files/figure-html/GTAP%20Macro%20Plot-1.png" width="700"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Reporting Table</span></span>
<span><span class="fu"><a href="../reference/scalar_table.html">scalar_table</a></span><span class="op">(</span><span class="va">Macros</span>, vars <span class="op">=</span> <span class="va">selected_marcro</span>, </span>
<span>             output_dir <span class="op">=</span> <span class="va">output.folder</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="detail-plot">Detail Plot<a class="anchor" aria-label="anchor" href="#detail-plot"></a>
</h2>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">reg_oth_sl4</span>, <span class="kw">function</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/detail_plot.html">detail_plot</a></span><span class="op">(</span><span class="va">df</span>,</span>
<span>              y_axis_from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Commodity"</span>, <span class="st">"Activity"</span><span class="op">)</span>,</span>
<span>              figure_separate_by <span class="op">=</span> <span class="st">"Region"</span>,</span>
<span>              plot_var <span class="op">=</span> <span class="va">reg_oth_map</span>,</span>
<span>              output_dir <span class="op">=</span> <span class="va">output.folder</span>,</span>
<span>              top_impact <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>              panel_rows <span class="op">=</span> <span class="fl">1</span>,</span>
<span>              panel_cols <span class="op">=</span> <span class="fl">8</span>,</span>
<span>              width <span class="op">=</span> <span class="fl">45</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; $qo</span></span>
<span><span class="co">#&gt; $qo$USA_qo</span></span></code></pre></div>
<p><img src="GTAPViz_plot_files/figure-html/Detail%20Plot-1.png" width="700"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $qo$CHN_qo</span></span></code></pre>
<p><img src="GTAPViz_plot_files/figure-html/Detail%20Plot-2.png" width="700"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $qo$CAN_qo</span></span></code></pre>
<p><img src="GTAPViz_plot_files/figure-html/Detail%20Plot-3.png" width="700"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $qo$ROW_qo</span></span></code></pre>
<p><img src="GTAPViz_plot_files/figure-html/Detail%20Plot-4.png" width="700"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $qxw</span></span>
<span><span class="co">#&gt; $qxw$USA_qxw</span></span></code></pre>
<p><img src="GTAPViz_plot_files/figure-html/Detail%20Plot-5.png" width="700"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $qxw$CHN_qxw</span></span></code></pre>
<p><img src="GTAPViz_plot_files/figure-html/Detail%20Plot-6.png" width="700"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $qxw$CAN_qxw</span></span></code></pre>
<p><img src="GTAPViz_plot_files/figure-html/Detail%20Plot-7.png" width="700"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $qxw$ROW_qxw</span></span></code></pre>
<p><img src="GTAPViz_plot_files/figure-html/Detail%20Plot-8.png" width="700"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $qmw</span></span>
<span><span class="co">#&gt; $qmw$USA_qmw</span></span></code></pre>
<p><img src="GTAPViz_plot_files/figure-html/Detail%20Plot-9.png" width="700"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $qmw$CHN_qmw</span></span></code></pre>
<p><img src="GTAPViz_plot_files/figure-html/Detail%20Plot-10.png" width="700"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $qmw$CAN_qmw</span></span></code></pre>
<p><img src="GTAPViz_plot_files/figure-html/Detail%20Plot-11.png" width="700"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $qmw$ROW_qmw</span></span></code></pre>
<p><img src="GTAPViz_plot_files/figure-html/Detail%20Plot-12.png" width="700"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $pmw</span></span>
<span><span class="co">#&gt; $pmw$USA_pmw</span></span></code></pre>
<p><img src="GTAPViz_plot_files/figure-html/Detail%20Plot-13.png" width="700"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $pmw$CHN_pmw</span></span></code></pre>
<p><img src="GTAPViz_plot_files/figure-html/Detail%20Plot-14.png" width="700"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $pmw$CAN_pmw</span></span></code></pre>
<p><img src="GTAPViz_plot_files/figure-html/Detail%20Plot-15.png" width="700"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $pmw$ROW_pmw</span></span></code></pre>
<p><img src="GTAPViz_plot_files/figure-html/Detail%20Plot-16.png" width="700"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $pxw</span></span>
<span><span class="co">#&gt; $pxw$USA_pxw</span></span></code></pre>
<p><img src="GTAPViz_plot_files/figure-html/Detail%20Plot-17.png" width="700"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $pxw$CHN_pxw</span></span></code></pre>
<p><img src="GTAPViz_plot_files/figure-html/Detail%20Plot-18.png" width="700"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $pxw$CAN_pxw</span></span></code></pre>
<p><img src="GTAPViz_plot_files/figure-html/Detail%20Plot-19.png" width="700"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $pxw$ROW_pxw</span></span></code></pre>
<p><img src="GTAPViz_plot_files/figure-html/Detail%20Plot-20.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="decomposition-plot">Decomposition Plot<a class="anchor" aria-label="anchor" href="#decomposition-plot"></a>
</h2>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Rename Value if needed</span></span>
<span><span class="va">welfare</span> <span class="op">&lt;-</span> <span class="va">har.plot.data</span><span class="op">[[</span><span class="st">"A"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">welfare</span><span class="op">[[</span><span class="st">"Variable"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Welfare"</span></span>
<span><span class="va">welfare</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rename_value.html">rename_value</a></span><span class="op">(</span><span class="va">har.plot.data</span><span class="op">[[</span><span class="st">"A"</span><span class="op">]</span><span class="op">]</span>, </span>
<span>                        column_name <span class="op">=</span> <span class="st">"COLUMN"</span>,</span>
<span>                        original_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"alloc_A1"</span>, <span class="st">"ENDWB1"</span>, <span class="st">"tech_C1"</span>, <span class="st">"pop_D1"</span>, <span class="st">"pref_G1"</span>, <span class="st">"tot_E1"</span>, <span class="st">"IS_F1"</span><span class="op">)</span>,</span>
<span>                        new_values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Alloc Eff."</span>, <span class="st">"Endwb"</span>, <span class="st">"Tech Chg."</span>, <span class="st">"Pop"</span>, <span class="st">"Perf"</span>, <span class="st">"ToT"</span>, <span class="st">"I-S"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define Decomposition</span></span>
<span><span class="fu"><a href="../reference/stack_plot.html">stack_plot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">welfare</span>,</span>
<span>          x_axis_from <span class="op">=</span> <span class="st">"Region"</span>,</span>
<span>          stack_value_from <span class="op">=</span> <span class="st">"COLUMN"</span>,</span>
<span>          title_prefix <span class="op">=</span> <span class="st">"Decomposition"</span>,</span>
<span>          output_dir <span class="op">=</span> <span class="va">output.folder</span>,</span>
<span>          separate_figure <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>          color_tone <span class="op">=</span> <span class="st">"green"</span>,</span>
<span>          width <span class="op">=</span> <span class="fl">30</span>,</span>
<span>          height <span class="op">=</span> <span class="fl">15</span>,</span>
<span>          legend_position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>          unstack_plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="GTAPViz_plot_files/figure-html/Decomposition%20Plot-1.png" width="700"></p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Table of Decomposition</span></span>
<span><span class="fu"><a href="../reference/decomp_table.html">decomp_table</a></span><span class="op">(</span><span class="va">har.plot.data</span>, </span>
<span>             header <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"E1"</span><span class="op">)</span>,</span>
<span>             wide_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>A <span class="op">=</span> <span class="st">"COLUMN"</span>, E1 <span class="op">=</span> <span class="st">"PRICES"</span><span class="op">)</span>,</span>
<span>             total_column <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>             output_dir <span class="op">=</span> <span class="va">output.folder</span>,</span>
<span>             export_table <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Pattawee Puangchit.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
