% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/table.R
\name{decomp_table}
\alias{decomp_table}
\title{Create Decomposition Table with Multi-Data Support}
\usage{
decomp_table(
  data_list,
  header,
  wide_cols,
  total_column = FALSE,
  export_table = FALSE,
  multi_sheet = FALSE,
  output_dir = NULL,
  sheet_names = NULL,
  include_units = FALSE
)
}
\arguments{
\item{data_list}{A named list of data frames. Each data frame must contain an "Experiment" column.}

\item{header}{A character vector specifying which dataset names from \code{data_list} should be processed.}

\item{wide_cols}{A named list specifying the column to be transformed into wide format for each dataset.
Example: \code{list(A = "COLUMN", E1 = "PRICES")}.}

\item{total_column}{Logical. If \code{TRUE}, calculates a total column for each dataset by summing numeric columns. Default is \code{FALSE}.}

\item{export_table}{Logical. If \code{TRUE}, exports the result to an Excel file. Default is \code{FALSE}.}

\item{multi_sheet}{Logical. If \code{TRUE}, each dataset is written to a separate sheet in the Excel file. Default is \code{FALSE}.}

\item{output_dir}{Optional character string specifying the directory where the Excel file should be saved.}

\item{sheet_names}{Optional named list providing custom names for sheets in the exported Excel file.}

\item{include_units}{Logical. If \code{TRUE} and a "Unit" column exists in the data, unit information is merged into the final output. Default is \code{FALSE}.}
}
\value{
A list of data frames, each containing wide-format decomposition data.
If \code{export_table = TRUE}, the results are also saved to an Excel file.
}
\description{
Processes decomposition data, allowing multiple data frames as input.
Converts specified columns into wide format per dataset while supporting multiple
headers, independent column selections, and optional total calculations.
}
\details{
\itemize{
\item If \code{data} is a single data frame, \code{header} is ignored, and \code{wide_cols} should be a single column name.
\item If \code{data} is a list of data frames, \code{header} must be specified to select relevant subsets of each dataset.
\item \code{wide_cols} must be a named list matching the names of \code{data} (e.g., \code{"A"}, \code{"E1"}).
\item When \code{total_column = TRUE}, numerical values in each row are summed into a "Total" column.
\item If \code{export_table = TRUE}, the function saves the result to an Excel file, either as a single sheet or multiple sheets (if \code{multi_sheet = TRUE}).
}
}
\examples{
\dontrun{
# Example list of data frames
har.plot.data <- list(
  A = data.frame(Experiment = c("Base", "Policy"),
                 Header = "A", COLUMN = c("Tariff", "NTM"), Value = c(10, 5)),
  E1 = data.frame(Experiment = c("Base", "Policy"),
                  Header = "E1", PRICES = c("GDP", "Consumption"), Value = c(105, 55))
)

# Convert decomposition tables for both datasets
result <- decomp_table(data_list = har.plot.data, header = c("A", "E1"),
                       wide_cols = list(A = "COLUMN", E1 = "PRICES"), total_column = TRUE)

# Export as an Excel file with multiple sheets
decomp_table(data_list = har.plot.data, header = c("A", "E1"),
             wide_cols = list(A = "COLUMN", E1 = "PRICES"),
             total_column = TRUE, export_table = TRUE, multi_sheet = TRUE,
             output_dir = "results", sheet_names = list(A = "Welfare", E1 = "Prices"))
}
}
