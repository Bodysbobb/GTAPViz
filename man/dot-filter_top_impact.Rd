% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot.R
\name{.filter_top_impact}
\alias{.filter_top_impact}
\title{Filter Top Impact Data}
\usage{
.filter_top_impact(data, top_impact, group_col)
}
\arguments{
\item{data}{A data frame or a list of data frames containing the dataset to be filtered.}

\item{top_impact}{A numeric value indicating the number of top impact factors to retain.
If \code{NULL}, all data is returned.}

\item{group_col}{A character string specifying the column to group by when filtering top impacts.}
}
\value{
A filtered data frame (or a list of data frames if \code{data} is a list),
containing only the top \code{top_impact} observations for each group.
}
\description{
This internal function filters the top \code{top_impact} observations
within each group in the dataset, selecting an equal number of positive
and negative impact values when possible.
}
\details{
\itemize{
\item The function works on both data frames and lists of data frames.
\item It ensures that \code{Value} is numeric and checks for required columns.
\item The function groups data by \code{Experiment}, \code{Variable}, \code{Unit}, and \code{group_col}.
\item It selects the top positive and negative values separately, maintaining balance.
\item If an insufficient number of negative (or positive) values exist, the remaining
quota is filled with the other category.
\item The final dataset is sorted by \code{Experiment}, \code{Variable}, \code{Unit}, \code{group_col},
and \code{Value}.
}
}
\keyword{internal}
